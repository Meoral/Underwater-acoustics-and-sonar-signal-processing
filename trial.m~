frequency = 50;
theta =0:0.01:pi/2;
n=length(theta);
theta1=linspace(0,90,n);
for a=0:1:3
  f=50*(2^a);
  subplot(2,2,a+1);
for i=0:3
vw=5*(2^i);
bet=4*((vw+2)/(vw+1))+(2.5*((f+0.1)^(-1/3))-4).*cos(theta).^(1/8);
Ss=10*log10(((tan(theta)).^bet).*((1+vw)^2)*((f+0.1)^(vw/150))*(10^(-5.05)));
plot(theta1,Ss,'LineWidth',2)
title(['Frequency = ',num2str(f),' kHz'])
xlabel('Grazing angle'),
ylabel('Surface reverberation [dB/m^2]') 
ax = gca;
ax.FontSize = 12;
hold on
end
end
hL = legend('WS = 5kn','WS = 10kn','WS = 20kn','WS = 40kn');
newPosition = [0.85 0.85 0.2 0.2];
newUnits = 'normalized';
set(hL,'Position', newPosition,'Units', newUnits);
hL.FontSize = 14;
